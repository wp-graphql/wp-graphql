# Codecov configuration
# https://docs.codecov.com/docs/codecov-yaml

# Fix path prefixes from Docker container paths to repo-relative paths
fixes:
  - '/var/www/html/wp-content/plugins/wp-graphql/::'

coverage:
  status:
    project:
      default:
        # Allow coverage to drop by up to 1% without failing
        threshold: 1%
    patch:
      default:
        # Require new code to have at least some coverage
        threshold: 1%

comment:
  # Show coverage diff in PR comments
  layout: 'reach,diff,flags,files'
  behavior: default
  require_changes: true

# Group coverage by test type and configuration
flags:
  wpunit:
    paths:
      - src/
    carryforward: true
  # Theme flags
  twentytwentyfive:
    paths:
      - src/
    carryforward: true
  twentytwentyone:
    paths:
      - src/
    carryforward: true
  # Multisite flags
  single:
    paths:
      - src/
    carryforward: true
  multisite:
    paths:
      - src/
    carryforward: true
